%%
%% Author: anju s
%% 
%% Tables and figures required for my thesis.
%%

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{thesisfiguresandtables} [2012/01/05]

\newcommand\matrixbraceright[2]{ % Input is length of brace (in
                                 %  coordinates), label
  \color{gray6}{
  \begin{tikzpicture}[decoration={brace,amplitude=5}]
    \draw[decorate] (0,#1) -- (0,0)%
      node[midway,sloped,above]{\footnotesize #2};%
  \end{tikzpicture}
  }
}
\newcommand\matrixbracetop[2]{ % Input is length of brace (in
                               %  coordinates), label
  \color{gray6}{  
  \begin{tikzpicture}[decoration={brace,amplitude=5}]
    \draw[decorate] (0,0) -- (#1,0)%
      node[midway,sloped,above]{\footnotesize #2};%
  \end{tikzpicture}
  }
}
\newcommand\matrixbracebottom[2]{ % Input is length of brace (in
                               %  coordinates), label
  \color{gray6}{  
  \begin{tikzpicture}[decoration={brace,amplitude=5}]
    \draw[decorate] (0,0) -- (#1,0)%
      node[midway,sloped,above]{\footnotesize #2};%
  \end{tikzpicture}
  }
}


\def\figcopmatrix{%
  \begin{figure}[htbp] %[t] %
    \centering {\figtabsize
      \begin{tabular}[h]{l|lcccl}
        $M_1$: & $M_1'$: &&&& $M_2$:\\
        &&&&&\\
        \begin{tabular}[h]{llll}
          $c_1$ & $c_2$ &$c_3$ &$c_4$\\
          &&&\\
          \un & 0   & \un & 0\\
          0   & \un & 0   & \un \\
          \un & 0   & 0   & \un
        \end{tabular}
        &
        \begin{tabular}[h]{llll}
          $c_3$ &$c_1$ &$c_4$& $c_2$\\
          &&&\\
          \un & \un & 0 & 0\\
          0 & 0 & \un & \un \\
          0 & \un & \un & 0
        \end{tabular}
        &&&&
        \begin{tabular}[h]{llll}
          $d_1$ & $d_2$ &$d_3$ &$d_4$\\
          % &&&\\
          &&&\\
          \un & \un & 0 & 0\\
          0 & \un & \un & 0 \\
          0 & \un & 0 & \un 
        \end{tabular}
      \end{tabular}
    }

    \caption[\figtabsize Matrices with and without COP.]{\figtabsize
      Matrices with and without COP. $M_1$ has COP because by
      permuting its columns, $c_1$-$c_4$, one can obtain $M_1'$ where
      the {\un}s in each row are consecutive. $M_2$, however, does not
      have COP since no permutation of its columns, $d_1$-$d_4$, will
      arrange {\un}s in each row consecutively \cite{d08phd}.}

    \label{fig:cop-matrix}
  \end{figure}
}%

\def\graphici{%
  $G_1$:\\ 
  \begin{tikzpicture}[every node/.style={circle,inner
      sep=1pt,fill=gray!80}] %
    % Using tree mode of drawing to avoid coordinate coding
    \node{$v_5$}%
      child{node (v3){$v_3$}%
        child{node (v4){$v_4$}}%
        child{node {}}% DUMMY to make alignment work
      }%
      child{node (v1){$v_1$}%
        child{node (v2){$v_2$}}%
        child{node (v6){$v_6$}}%
      }%
      ;%

      \draw (v3)--(v1);%
      \draw (v2)--(v4);%     
      \draw (v2)--(v6);%
  \end{tikzpicture}
}%

\def\graphiciixxxxxxxx{%
  $G_2$:\\
  \begin{tikzpicture}[every node/.style={circle,inner
      sep=1pt,fill=gray!80}] % 
    % Using tree mode of drawing to avoid coordinate coding
    \node(v1){$v_1$}%
      child{node (v2){$v_2$}}%
      child{node (v3){$v_3$}}%
      child{node (v4){$v_4$}%
        child{node[right] (v5){$v_5$}}%
        child{node (v6){$v_6$}}%
      }%
      ;%

      \draw (v3)--(v5);%
      \draw (v1)--(v5);%   
  \end{tikzpicture}
}%

\def\graphicii{%
  $G_2$:\\
  \begin{tikzpicture}[every node/.style={circle,inner
      sep=1pt,fill=gray!80}] %

    \draw% Only declare nodes without real labels but with dummy
         % labels to get the "bounding box" size right.
      (1    ,1)      node(v5){xx}%
      (2.5  ,0.5)    node(v4){xx}%
      (3.75 ,0.00)   node(v6){xx}%
      (-1   ,2.75)   node(v2){xx}%
      (0    ,1)      node(v3){xx}%
      (1    ,2.5)    node(v1){xx}%
      ;%
      
    % Declare cliques without labels.
    \node[rectangle, rounded corners=10pt, inner sep=3pt,%
      fill=red!30, opacity=0.5, fit = (v1) (v2)](c1){}; %%
    \node[rectangle, rounded corners=10pt, inner sep=1pt,%
      fill=blue!30, opacity=0.5, fit = (v1) (v3) (v5)](c2){}; %%
    \node[rectangle, rounded corners=10pt, inner sep=5pt,%
      fill=green!30, opacity=0.5, fit = (v1) (v4) (v5)](c3){}; %%
    \node[rectangle, rounded corners=10pt, inner sep=3pt,%
      fill=orange!30, opacity=0.5, fit = (v4) (v6),sloped](c4){}; %%

    \draw% Draw edges before node labels.
      (v1) -- (v2)%
      (v1) -- (v3) -- (v5)%
      (v1) -- (v4) -- (v5)% 
      (v1) -- (v5)% 
      (v4) -- (v6)% 
      ;%
    \draw% Label nodes.
      (v5) node{$v_5$}%
      (v4) node{$v_4$}%
      (v6) node{$v_6$}%
      (v2) node{$v_2$}%
      (v3) node{$v_3$}%
      (v1) node{$v_1$}%
      ;%
          
    % Label cliques
    \draw (c1) node[fill=none,color=red,above=3pt]{$c_1$}; %
    \draw (c2) node[fill=none,color=blue,left=7pt]{$c_2$}; %
    \draw (c3) node[fill=none,color=green,right=18pt]{$c_3$}; %
    \draw (c4) node[fill=none,color=orange,below=3pt]{$c_4$};%
  \end{tikzpicture}
}%




\def\graphiciii{%
  $H$:\\\\
  \begin{tikzpicture}[every node/.style={circle,inner sep=1pt}] %
    \draw%
      (0,4) node[fill=gray!50](u1){$u_1$}
      (0,3) node[fill=gray!50](u2){$u_2$}
      (0,2) node[fill=gray!50](u3){$u_3$}
      (0,1) node[fill=gray!50](u4){$u_4$}
      (0,0) node[fill=gray!50](u5){$u_5$}

      (2,3.5) node[fill=gray!25](w1){$w_1$}
      (2,2.5) node[fill=gray!25](w2){$w_2$}
      (2,1.5) node[fill=gray!25](w3){$w_3$}
      (2,0.5) node[fill=gray!25](w4){$w_4$};
    
      \draw (u1)--(w1);%
      \draw (u1)--(w2);%
      \draw (u2)--(w1);%
      \draw (u2)--(w2);%
      \draw (u2)--(w3);%
      \draw (u2)--(w4);%
      \draw (u3)--(w3);%
      \draw (u3)--(w4);%
      \draw (u4)--(w2);%
      \draw (u4)--(w3);%
      \draw (u5)--(w1);%
      \draw (u5)--(w2);%
      \draw (u5)--(w3);%

   \end{tikzpicture}
}%

\def\figgraphmatrices{%
  \begin{figure}[htbp]% [t] % [p]%
    \centering
%    \figtabsize
  \begin{tabular}{ll}
    
    %\includegraphics[bb=120 120 150 180
    %,scale=0.4]{../img/graphmatrices_g1.png} 
    \graphici
   &                 % COL BREAK
   \begin{tabular}[b]
      {>{\columncolor{\tblhcolor}}  l llllll}                       % Shade header col..
      \rowcolor[gray]{0.8}                                          % ..and row
      ${\bf A_2}$&$v_1$ &$v_2$ &$v_3$ &$v_4$ &$v_5$ &$v_6$\\
      % \hline
      $v_1$ &\un   &\un   &\un  &0     &\un   &\un \\
      $v_2$ &\un   &\un   &\un  &\un   &0     &\un \\
      $v_3$ &\un   &\un   &\un  &\un   &\un   &0   \\
      $v_4$ &0     &\un   &\un  &\un   &0     &0   \\
      $v_5$ &\un   &0     &\un  &0     &\un   &0   \\
      $v_6$ &\un   &\un   &0    &0     &0     &\un 
    \end{tabular}    
    \\
    & \\
    \begin{tabular}[b]%{l|lll lll}
      {>{\columncolor{\tblhcolor}}  l llllll}                       % Shade header col..
      \rowcolor[gray]{0.8}                                          % ..and row
      ${\bf A_1}$ &$v_1$ &$v_2$ &$v_3$ &$v_4$ &$v_5$ &$v_6$\\
      % \hline
      $v_1$     &0     &\un   &\un  &0     &\un   &\un \\
      $v_2$     &\un   &0     &\un  &\un   &0     &\un \\
      $v_3$     &\un   &\un   &0    &\un   &\un   &0   \\
      $v_4$     &0     &\un   &\un  &0     &0     &0   \\
      $v_5$     &\un   &0     &\un  &0     &0     &0   \\
      $v_6$     &\un   &\un   &0    &0     &0     &0   
    \end{tabular}
   &                 % COL BREAK
    \begin{tabular}[b]
      {>{\columncolor{\tblhcolor}}  l llllll}                       % Shade header col..
      \rowcolor[gray]{0.8}                                          % ..and row
      ${\bf A_2'}$ &$v_1$ &$v_6$ &$v_2$ &$v_4$ &$v_3$ &$v_5$\\
      % \hline
      $v_1$ &\un   &\un   &\un  &0     &\un   &\un \\
      $v_6$ &\un   &\un   &\un  &0     &0     &0   \\
      $v_2$ &\un   &\un   &\un  &\un   &\un   &0   \\
      $v_4$ &0     &0     &\un  &\un   &\un   &0   \\
      $v_3$ &\un   &0     &\un  &\un   &\un   &\un \\
      $v_5$ &\un   &0     &0    &0     &\un   &\un 
    \end{tabular}
    \\    
    & \\

    %\includegraphics[bb=120 120 150 180,
    %scale=0.5,keepaspectratio=true]{../img/graphmatrices_g2.png} 
    \graphicii
    &                 % COL BREAK
    \begin{tabular}[b]
      {>{\columncolor{\tblhcolor}}  l llll}                         % Shade header col..
      \rowcolor[gray]{0.8}                                          % ..and row
      ${\bf B}$&$c_1$ &$c_2$ &$c_3$ &$c_4$\\
      % \hline
      $v_1$ &\un   &\un   &\un   &0   \\
      $v_2$ &\un   &0     &0     &0   \\
      $v_3$ &0     &\un   &0     &0   \\
      $v_4$ &0     &0     &\un   &\un \\
      $v_5$ &0     &\un   &\un   &0   \\
      $v_6$ &0     &0     &0     &\un  
    \end{tabular}
    \\
    & \\
    %\includegraphics[scale=0.4]{../img/graphmatrices_H.png} 
    \graphiciii
    &                 % COL BREAK
    \begin{tabular}[b]
      {>{\columncolor{\tblhcolor}}  l llll}                       % Shade header col..
      \rowcolor[gray]{0.8}                                        % ..and row
      ${\bf C}$ &$w_1$ &$w_2$ &$w_3$ &$w_4$\\                      
      % \hline
      $u_1$ &\un   &\un   &0     &0   \\
      $u_2$ &\un   &\un   &\un   &\un \\
      $u_3$ &0     &0     &\un   &\un \\
      $u_4$ &0     &\un   &\un   &0   \\
      $u_5$ &\un   &\un   &\un   &0   
    \end{tabular}
    \\
  \end{tabular}

  \caption[\figtabsize Matrices defined in
  Def.~\ref{def:graphmatrices}]{\figtabsize $A_1$ is the {\em
      adjacency matrix} and $A_2$ is the {\em augmented adjacency
      matrix} of $G_1$. $A_2'$ is obtained from $A_2$ by permuting its
    rows and columns to achieve {\em \CROP order}, \ie $A_2$ has
    \CROP\,-- thus $G_1$ is {\em a concave-round graph}
    (Def.~\ref{def:graphwithcop}~\ref{def::concave-round}) and {\em a
      circular-arc graph} (Tab.~\ref{tab:graphmatrices}) $B$ is the
    maximal clique matrix of $G_2$ and has \COP\,-- thus $G_2$ is an
    {\em interval
      graph}(Def.~\ref{def:graphwithcop}~\ref{def::concave-round}). $C$
    is the half adjacency matrix of bipartite graph $H$ and has \COP
    on rows -- thus $H$ is {a convex bipartite graph}.}
  \label{fig:graphmatrices}
  \end{figure}
}%



\def\figpqtree{%
  \begin{figure}[htbp]
    \centering
    \begin{tabular}[h]{lr}
      \begin{tabular}[h]
        {>{\columncolor{\tblhcolor}} l lllllllllll|}
        \hline
        $r_1$   &\un &0   &\un &0   &0   &0    &0   \\
        $r_2$   &\un &0   &\un &0   &0   &0    &0   \\
        $r_3$   &\un &0   &0   &\un &0   &0    &0   \\
        $r_4$   &\un &0   &0   &\un &0   &0    &0   \\
        $r_5$   &\un &0   &0   &0   &0   &0    &0   \\
        $r_6$   &\un &\un &0   &0   &0   &0    &0   \\
        $r_7$   &0   &\un &0   &0   &0   &\un  &0   \\
        $r_8$   &0   &\un &0   &0   &\un &\un  &0   \\
        $r_9$   &0   &\un &0   &0   &\un &\un  &0   \\
        $r_{10}$ &0   &\un &0   &0   &\un &\un  &\un \\
        $r_{11}$ &0   &\un &0   &0   &\un &0    &\un \\
        \hline
      \end{tabular}
      &
      \includegraphics[scale=0.3]{../img/pqtree.png}
    
    \end{tabular}
 
    \caption[\figtabsize An example for \PQtree]{\figtabsize An
      example for \PQtree.  Permuting the order of the left child of
      the root, we see that \temptext{(d,a,b,c,e,f,g,h,i,j,k)} is a
      \COP order. Reversing the order of the right child of the root,
      we see that \temptext{(a,b,c,d,e,f,k,j,h,i,g) } is yet another
      \COP order. \temptext{PLACEHOLDER IMG.}
      \cite[Fig.~1\endnote{\cite{mcc04}illustrates \COP on rows. Our
        convention in this document is \COP on columns and thus
        example matrix has been transposed. }]{mcc04}}
    \label{fig:pqtree}
  \end{figure}
}%


\def\tabgraphmatrices{%
  \begin{table}[htbp]
    \def\hcolwidth {3cm}% 
    \def\colwidth {2.25cm}% 
    \def\supset{\ \ \ $\bigcap$ \\\par}
    \def\subset{\ \ \ $\bigcup$ \\\par}
    \centering
    {
      \fontencoding{OT1}\fontfamily{cmss}\selectfont%
      \footnotesize%
      \setlength\extrarowheight{0.3in}

      \begin{tabular}
        {|>{\columncolor{\tblhcolor}}  lllll|} % Header column colored
        \hline

        \rowcolor[gray]{0.8} %                 Header row colored
        \parbox[b]{\hcolwidth}{\sc Graph class} & 
        \parbox[b]{\colwidth}{ \sc Adjacency matrix} & 
        \parbox[b]{\colwidth}{ \sc Augmented adjacency matrix}& 
        \parbox[b]{\colwidth}{ \sc Half\\ adjacency matrix} & 
        \parbox[b]{\colwidth}{ \sc Maximal clique \\matrix}\\ 
      

        \parbox[b]{\hcolwidth}{Convex-round} & 
        \parbox[c]{\colwidth}{ $\Leftrightarrow$ \CROP \\ (by defn.)} & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ }\\ 

      
        \parbox[b]{\hcolwidth}{Concave-round} & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ $\Leftrightarrow$ \CROP\\ (by defn.)} & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ }\\

       % \parbox[t]{\hcolwidth}{ $\bigcap$}\\

        \parbox[b]{\hcolwidth}{{\supset} {Circular-arc}} & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ $\Leftarrow$ \CROP \\ \cite{at72}} & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ $\Leftarrow$ \CROP}\\

        \parbox[b]{\hcolwidth}{{\subset} Helly circular-arc} & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ $\Leftarrow$ \COP} & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ $\Leftrightarrow$ \CROP \\ \cite{gav74}}\\


        \parbox[b]{\hcolwidth}{{\subset} Interval} & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ $\Leftarrow$ \COP} & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ $\Leftrightarrow$ \COP \\ \cite{fg65} }\\

        \parbox[b]{\hcolwidth}{{\subset} Proper/unit interval} & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ $\Leftrightarrow$ \COP \\ \cite{rob69}} & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ $\Leftrightarrow$ \COP$r+c$ \\ \cite{fis85} }\\

        % \hline
        \rowcolor[gray]{0.8}&\multicolumn{4}{c|}{\sc Bipartite graphs}\\
        % \hline

        \parbox[b]{\hcolwidth}{Circular convex} & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ $\Leftrightarrow$ \CROP \\ (by defn.)} & 
        \parbox[c]{\colwidth}{ }\\

        \parbox[b]{\hcolwidth}{{\subset} Convex} & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ $\Leftrightarrow$ \COP \\ (by defn.)} & 
        \parbox[c]{\colwidth}{ }\\


        \parbox[b]{\hcolwidth}{{\subset} Biconvex} & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ } & 
        \parbox[c]{\colwidth}{ $\Leftrightarrow$ \COP $r+c$ \\ (by defn.)} & 
        \parbox[c]{\colwidth}{ }\\

        \hline
      \end{tabular}
    }
    \caption[\figtabsize Relationship between graph classes and graph
    matrices with \COP or \CROP.]{\figtabsize Relationship between graph classes and graph
      matrices in termes of their \COP or \CROP. The arrows indicate the
      implication of the statement. $\Leftrightarrow$ indicates that the
      membership in the graph class and the matrix propery are
      equivalent. $\Leftarrow$ indicates that the matrix property implies
      the membership in the graph class. $r+c$ indicates that the property
      holds on rows and columns of the matrix. $\bigcup$ and $\bigcap$
      indicate that the graph class above is a superset or subset, respectively, of
      the graph class below.   \cite[Tab.~2.1]{d08phd}}
    \label{tab:graphmatrices}
  \end{table}
}%


\def\tabparboxw{10cm}% 
\def\tabcophistory{%
  \begin{table}[htbp]
    \centering
    {
      \fontencoding{OT1}\fontfamily{cmss}\selectfont%
      \footnotesize%

      \begin{tabular}{lll}
        \hline
        \hline

        1899 & \parbox[t]{\tabparboxw}{ First mention of \COP
          (archaeology)} &   \cite{ken69} \\

        \rowcolor[gray]{0.8} %
        1951 & \parbox[t]{\tabparboxw}{ Heuristics for COT} & \cite{wsr51} \\

        1965 & \parbox[t]{\tabparboxw}{ First polynomial time algorithm
          for \COP testing} & \cite{fg65} \\ 

        \rowcolor[gray]{0.8} %
        1972 & \parbox[t]{\tabparboxw}{ Characterization for \COP -- forbidden
          submatrices} &
        \cite{at72} \\

        1976 & \parbox[t]{\tabparboxw}{ First linear time algorithm for COT --
          \PQtree} &
        \cite{bl76} \\

        \rowcolor[gray]{0.8} %
        1992 & \parbox[t]{\tabparboxw}{ Linear
          time algorithm COT without \PQtree} & \cite{wlh02}%\footnote{First
        % published in \cite{wlh02isaac92}}
        \\

        2001 & \parbox[t]{\tabparboxw}{\PCtree\ -- a simplification of
          \PQtree} & \cite{wlh01,hm03} \\  

        \rowcolor[gray]{0.8} %     
        1996 & \parbox[t]{\tabparboxw}{\PQRtree\ -- generalization of
          \PQtree for any binary matrix regardless of its \COP status} &
        \cite{mm96} \\ 

        1998 & \parbox[t]{\tabparboxw}{ Almost linear time to construct
          \PQRtree} & \cite{mpt98} \\ 

        \rowcolor[gray]{0.8} %
        2004 & \parbox[t]{\tabparboxw}{ A certifying algorithm for no
          \COP.\\ Generalized \PQtree.} & \cite{mcc04} \\ 

        2009 & \parbox[t]{\tabparboxw}{ Set theoretic, cardinality based
          characterization of \COP\ -- ICPIA} & \cite{nsnrs09} \\ 

        \rowcolor[gray]{0.8} %
        2010 & \parbox[t]{\tabparboxw}{ Logspace \COP testing} &
        \cite{kklv10}\\ 
        \hline
        \hline
      \end{tabular}
    }
    \caption[\figtabsize A brief history of \COP research]{\figtabsize A
      brief history of \COP research }
    \label{tab:cophistory}
  \end{table}
}%


\def\forbiddenMIstr{$M_{I_k}, k \ge 1$}%
\def\forbiddenMIIstr{$M_{II_k}, k \ge 1$}%
\def\forbiddenMIIIstr{$M_{III_k}, k \ge 1$}%
\def\forbiddenMIVstr{$M_{IV}$}%
\def\forbiddenMVstr{$M_{V}$}%

\def\forbiddenMI{%
     \begin{tabular}[b]{|lll ll l|l} %                   MATRIX 1
%        \multicolumn{7}{l}{\normalsize \hspace{\mindent} $M_{I_k}, k \ge 1$}\\   
        \multicolumn{6}{c}{\matrixbracetop{3.25}{$k+2$}}   \\
        \cline{1-6} % \firsthline %      Begin matrix  %%%%%%
        \un & \un & 0   & \multicolumn{2}{c}{\dots}  & 0    &
        \hspace{-0.1in}\multirow{5}{*}{\matrixbraceright{2.5}{$k+2$}}   \\    
        0   & \un & \un & 0 & ...& 0   \\
        \multicolumn{6}{|c|}{\dots}                        \\
        0   & \multicolumn{2}{c}{\dots}  & 0   & \un & \un \\
        \cline{1-6} % \hdashline %%%%%%%%%%%%%%%%%%%%%%%%%%%%
        \un & 0   & \multicolumn{2}{c}{\dots}  & 0   & \un \\
        \cline{1-6} % \lasthline %      End matrix  %%%%%%%%%
      \end{tabular}
}%
\def\forbiddenMII{%
      \begin{tabular}[b]{|lll ll ll|l} %                   MATRIX 2
%        \multicolumn{8}{l}{\normalsize \hspace{\mindent}$M_{II_k}, k \ge 1$}\\
        \multicolumn{7}{c}{\matrixbracetop{3.8}{$k+3$}}            \\ 
        \cline{1-7}%  \firsthline %      Begin matrix  %%%%%%%%%%%%
        \un & \un & 0   & \multicolumn{3}{c:}{\dots}       & 0    &
        \hspace{-0.1in}\multirow{6}{*}{\matrixbraceright{3}{$k+3$}}     \\
        0   & \un & \un & 0 & \multicolumn{2}{c:}{\dots}   & 0   \\ 
        \multicolumn{6}{|c:}{\dots}                        &     \\
        0   & \multicolumn{2}{c}{\dots}  & 0   & \un              &
        \multicolumn{1}{l:}{\un} & 0                           \\
        \cline{1-6}    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        0   & \un & \multicolumn{4}{c}{\dots}              & \un \\
        \un & \multicolumn{3}{c}{\dots}        & \un & 0   & \un \\
        \cline{1-7}% \lasthline %      End matrix  %%%%%%%%%%%%%%%%
      \end{tabular}
}%
\def\forbiddenMIII{%
      \begin{tabular}[b]{|lll ll l l|l} %                  MATRIX 3 
%        \multicolumn{8}{l}{\normalsize \hspace{\mindent}$M_{III_k}, k \ge 1$}\\
        \multicolumn{7}{c}{\matrixbracetop{3.8}{$k+3$}}            \\
        \cline{1-7}%      \firsthline %      Begin matrix %%%%%%%%%
        \un & \un & 0   & \multicolumn{3}{c:}{\dots}       & 0    &
        \hspace{-0.1in}\multirow{5}{*}{\matrixbraceright{2.5}{$k+2$}}   \\
        0   & \un & \un & 0 & \multicolumn{2}{c:}{\dots}   & 0   \\ 
        \multicolumn{6}{|c:}{\dots}                        &     \\
        0   & \multicolumn{2}{c}{\dots}  & 0   & \un              &
        \multicolumn{1}{l:}{\un}                         & 0   \\
        \cline{1-6}    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        0   & \un & \multicolumn{2}{c}{\dots}  & \un & 0   & \un \\
        \cline{1-7}%      \lasthline %      End matrix %%%%%%%%%%%%
      \end{tabular}
}%
\def\forbiddenMIV{%
      \begin{tabular}[b]{|llllll|}  %                     MATRIX 4
%        \multicolumn{6}{l}{\normalsize \hspace{\mindent}$M_{IV}$} \\
        \multicolumn{6}{l}{} \\
        \firsthline
        \un & \un & 0 & 0 & 0 & 0   \\
        0 & 0 & \un & \un & 0 & 0   \\
        0 & 0 & 0 & 0 & \un & \un   \\
        \un & 0 & \un & 0 & \un & 0 \\
        \lasthline
      \end{tabular}
}%
\def\forbiddenMV{%
      \begin{tabular}[b]{|lllll|}  %                     MATRIX 5
%        \multicolumn{5}{l}{\normalsize \hspace{\mindent}$M_{V}$} \\
        \multicolumn{5}{l}{} \\
        \firsthline
        \un & \un & 0   & 0   & 0   \\
        0   & 0   & \un & \un & 0   \\
        \un & \un & \un & \un & 0   \\
        \un & 0   & \un & 0   & \un \\
        \lasthline
      \end{tabular}
}%


\def\figforbiddensubmatrices{
  \begin{figure}[htbp]
    \centering
    % \includegraphics[scale=0.35]{../img/tuckersforbiddensubmatrices.png}
    \setlength\dashlinedash{1pt} %
    \setlength\dashlinegap{0pt} % Make non zero if cline can be done
    % with dashed lines.
    \def\mindent{0in}
    \singlespacing
    \begin{tabular}[h]{lll}
      \forbiddenMIstr   &         \forbiddenMIVstr & \forbiddenMVstr  \\
      \forbiddenMI      &         \forbiddenMIV    & \forbiddenMV  \\
      \\
    \end{tabular}
    \begin{tabular}[h]{ll}
      \forbiddenMIIstr  &  \forbiddenMIIIstr \\
      \forbiddenMII     &  \forbiddenMIII    \\


    \end{tabular}

    \caption[\figtabsize Tucker's forbidden submatrices]{\figtabsize
      Tucker's forbidden submatrices for convex bipartite
      graphs. \cite{at72}}
    \label{fig:forbiddensubmatrices}
  \end{figure}
}

\def\graphgik{%
  %$G_{I_k}$:
  \begin{tikzpicture}[every node/.style={circle,inner
      sep=2pt},decoration={brace,amplitude=6}] %,inner sep=1pt 
    
%    \draw[help lines] (-3,-1) grid (3,3); 
    
    \draw%
      (0,2.6) node[draw](root){}
      ;%
    \draw
      (-1.2,1.8) node[fill](left){}%
      (1.2,1.8) node[fill](right){}% 
      ;%
    \draw%
      (-2.4,1) node[draw](wl1){}%
      (-1.6,1) node[draw](wl2){}%
      (-0.8,1) node[draw](wl3){}%
      (0.8,1) node[draw](wr3){}%
      (1.6,1) node[draw](wr2){}%
      (2.4,1) node[draw](wr1){}%
      ;%
    \draw%
      (-2.0,0) node[fill](bl1){}%
      (-1.2,0) node[fill](bl2){}%
      (1.2,0) node[fill](br2){}%
      (2.0,0) node[fill](br1){}%
      ;%
    \node (xbl) at (-0.4,0) {};
    \node (xbr) at (0.4,0) {};
    \node (braceleft) at (-2,-0.3) {};
    \node (braceright) at (2,-0.3) {};
      
    \draw 
      (root)--(left)      (root)--(right)%

      (left)--(wl1)       (wl1)--(bl1)      (bl1)--(wl2)%
      (wl2)--(bl2)        (bl2)--(wl3)%

      (right)--(wr1)      (wr1)--(br1)      (br1)--(wr2)
      (wr2)--(br2)        (br2)--(wr3)%
    ;%
    \draw[dashed]% -OR- loosely/densely dotted -OR- dashed -OR-
                 % loosely/densely dashed 
      (wl3)--(xbl)      (wr3)--(xbr)%
      ;%
    \draw%
      (braceright) (braceleft)%
      node[midway,above=0.5]{$\ldots$}%
      ;% 
    \draw[gray6,decorate]%
      (braceright) -- (braceleft)%
      node[midway,sloped,below=0.2]{$k$}
      ;%
  \end{tikzpicture}
}%

\def\graphgiik{%
  %$G_{II_k}$:\\\\
  \begin{tikzpicture}[every node/.style={circle,inner
      sep=2pt},decoration={brace,amplitude=6}] %,inner sep=1pt 
    
%    \draw[help lines] (-3,-1) grid (3,3); 
    
    \draw%
      (0,2.6) node[draw](root){}
      ;%
    \draw
      (-1.2,1.8) node[fill](left){}%
      (1.2,1.8) node[fill](right){}% 
      ;%
    \draw%
      (-2.4,1) node[draw](wl1){}%
      (-1.6,1) node[draw](wl2){}%
      (-0.8,1) node[draw](wl3){}%
      (0.8,1) node[draw](wr3){}%
      (1.6,1) node[draw](wr2){}%
      (2.4,1) node[draw](wr1){}%
      ;%
    \draw%
      (-2.0,0) node[fill](bl1){}%
      (-1.2,0) node[fill](bl2){}%
      (1.2,0) node[fill](br2){}%
      (2.0,0) node[fill](br1){}%
      ;%
    \node (xbl) at (-0.4,0) {};
    \node (xbr) at (0.4,0) {};
    \node (braceleft) at (-2,-0.3) {};
    \node (braceright) at (2,-0.3) {};
      
    \draw 
      (root)--(left)      (root)--(right)%
      (left)--(wl1)       (wl1)--(bl1)      (bl1)--(wl2)%
      (wl2)--(bl2)        (bl2)--(wl3)%
      (right)--(wr1)      (wr1)--(br1)      (br1)--(wr2)
      (wr2)--(br2)        (br2)--(wr3)%

      % G_IIk specific edges
      (left)--(wr2)       (left)--(wr3)     (left)--(wl3)%
      (left)--(wl2)%
      (right)--(wr2)      (right)--(wr3)    (right)--(wl3)%
      (right)--(wl2)%
    ;%

    \draw[dashed]
      (wl3)--(xbl)      (wr3)--(xbr)%
      ;%

    \draw%
      (braceright) (braceleft)%
      node[midway,above=0.5]{$\ldots$}%
      ;% 
  
    \draw[gray6,decorate]%
      (braceright) -- (braceleft)%
      node[midway,sloped,below=-0.2]{$k+1$} % The + sign seems to push
                                            %  it too far below. 
      ;%

  \end{tikzpicture}
}%

\def\graphgiiik{%
  %$G_{III_k}$:\\\\
  \begin{tikzpicture}[every node/.style={circle,inner
      sep=2pt},decoration={brace,amplitude=6}] %,inner sep=1pt 
    
%    \draw[help lines] (-3,-1) grid (3,3); 
    
    \draw%
      (0,2.6) node[draw](root){}
      % G_IIIk specific node      
      (0,1.8) node[fill](black){}
      ;%
    \draw%
      (-2.4,1) node[draw](wl1){}%
      (-1.6,1) node[draw](wl2){}%
      (-0.8,1) node[draw](wl3){}%
      (0.8,1) node[draw](wr3){}%
      (1.6,1) node[draw](wr2){}%
      (2.4,1) node[draw](wr1){}%
      ;%
    \draw%
      (-2.0,0) node[fill](bl1){}%
      (-1.2,0) node[fill](bl2){}%
      (1.2,0) node[fill](br2){}%
      (2.0,0) node[fill](br1){}%
      ;%
    \node (xbl) at (-0.4,0) {};
    \node (xbr) at (0.4,0) {};
    \node (braceleft) at (-2,-0.3) {};
    \node (braceright) at (2,-0.3) {};
      
    \draw 
      (root)--(black)%
      (wl1)--(bl1)        (bl1)--(wl2)%
      (wl2)--(bl2)        (bl2)--(wl3)%
      (wr1)--(br1)        (br1)--(wr2)
      (wr2)--(br2)        (br2)--(wr3)%

      % G_IIIk specific edges
      (black)--(wr2)       (black)--(wr3)     (black)--(wl3)%
      (black)--(wl2)%
    ;%

    \draw[dashed]
      (wl3)--(xbl)      (wr3)--(xbr)%
      ;%

    \draw%
      (braceright) (braceleft)%
      node[midway,above=0.5]{$\ldots$}%
      ;% 
  
    \draw[gray6,decorate]%
      (braceright) -- (braceleft)%
      node[midway,sloped,below=-0.2]{$k+1$} % The + sign seems to push
                                            %  it too far below.
      ;%
  \end{tikzpicture}
}%

\def\graphgiv{%
  %$G_{IV}$:\\\\
  \begin{tikzpicture}[every node/.style={circle,inner sep=2pt}] 

%   \draw[help lines] (-3,-3) grid (3,3); 
    
    \draw%
      (0,0)   node[fill](center){}

      (0,0.5) node[draw](wtop){}
      (0,1)   node[fill](btop){}
      (0,1.5) node[draw](wtopmost){}

      (-0.433,-0.25) node[draw](wleft){}
      (-0.866,-0.5)   node[fill](bleft){}
      (-1.299,-0.75) node[draw](wleftmost){}

      (0.433,-0.25) node[draw](wright){}
      (0.866,-0.5)   node[fill](bright){}
      (1.299,-0.75) node[draw](wrightmost){}      
     ;%
     
    \draw 
      (center)--(wtop)    (wtop)--(btop)      (btop)--(wtopmost)%
      (center)--(wleft)   (wleft)--(bleft)    (bleft)--(wleftmost)%
      (center)--(wright)  (wright)--(bright)  (bright)--(wrightmost)%
      ;%
  \end{tikzpicture}
}%

\def\graphgv{%
  %$G_{V}$:\\\\
  \begin{tikzpicture}[every node/.style={circle,inner sep=2pt}] 

%   \draw[help lines] (-3,-3) grid (3,3); 
    
    \draw%
      (0,1.5)   node[draw]  (wtop){}
      (0,1)     node[fill]  (btop){}
      (-2,0)    node[fill]  (bleft){}
      (-1,0.5)  node[draw]  (wlefttop){}
      (-1,-0.5) node[draw]  (wleftbottom){}
      (2,0)     node[fill]  (bright){}
      (1,0.5)   node[draw]  (wrighttop){}
      (1,-0.5)  node[draw]  (wrightbottom){}
      (0,0)     node[fill]  (centerblack){}
      ;%
     
    \draw 
      (wtop)--(btop)  (btop)--(wlefttop)  (btop)--(wrighttop)%
      (wrighttop)--(centerblack)--(wrightbottom)--(bright)--(wrighttop)%
      (wlefttop)--(centerblack)--(wleftbottom)--(bleft)--(wlefttop)%
      ;
     
  \end{tikzpicture}
}%

\setlength\intextsep{5pt}
\setlength\textfloatsep{5pt}


\def\figforbiddensubgraphs{%
  \begin{figure}[htbp]
    \centering
    %\includegraphics[scale=0.35]{../img/tuckersforbiddensubgraphs.png}
    \begin{tabular}[h]{lll}
      $G_{I_k}:$ & $G_{II_k}:$ & $G_{III_k}:$\\
      \graphgik & \graphgiik & \graphgiiik
    \end{tabular}

    \begin{tabular}[h]{ll}
      $G_{IV}:$ & $G_{V}:$\\
      \graphgiv & \graphgv 
    \end{tabular}

    \caption[\figtabsize Tucker's forbidden subgraphs]{\figtabsize
      Tucker's forbidden subgraphs for convex bipartite
      graphs.}
    \label{fig:forbiddensubgraphs}
  \end{figure}
}%

\def\ksubstari{%
  \begin{tikzpicture}[every node/.style={circle, inner sep=1pt,fill}]%
    \draw%
    \foreach \rot in {0,30,60,90,120,150,180}% rays = 7
    {%
      (0,0) node (root) {}%
      \foreach \x in {0.4,0.8,...,4}% k = 8
      {%
        [rotate=\rot] -- (\x,0) node {}%
      }%
    }%
    ;%

    \draw (root) node[fill=none,below=2pt] {$r$};%
    \draw (root) node[fill=none,below left=16pt] {$k = 8$};%
  \end{tikzpicture}
}%

\def\ksubstarii{%
  \begin{tikzpicture}[every node/.style={circle, inner sep=1pt,fill}]%
    \draw%
    \foreach \rot in {30,90,150}% rays = 3
    {%
      (0,0) node (root) {}%
      \foreach \x in {0.5,1,...,2}% k = 3
      {%
        [rotate=\rot] -- (\x,0) node {}%
      }%
    }%
    ;%

    \draw (root) node[fill=none,below=2pt] {$r$};%
    \draw (root) node[fill=none,below left=16pt] {$k = 3$};%
  \end{tikzpicture}
}%


\def\hypergraphiii{%
  \begin{tikzpicture}[every node/.style={circle,inner sep=1pt,fill=none}]%
%   \draw[help lines] (0,0) grid (5,5);%
    \draw%
      (1,3)       node(x5) {$x_5$} %
      (0,2.25)    node(x3) {$x_3$} %
      (1,2)       node(x2) {$x_2$} %
      (3,2.5)     node(x8) {$x_8$} %
      (3,3)       node(x9) {$x_9$} %
      (2,4)       node(x6) {$x_6$} %
      (0,0)       node(x1) {$x_1$} %
      (3.5,1.5)   node(x7) {$x_7$} %
      (3,0)       node(x4) {$x_4$} %
      ;%

    \begin{pgfonlayer}{background}
    \node[ellipse, rotate fit=40, inner sep=0pt,%
      fill=red!30, opacity=0.3, draw, fit = (x1) (x2)]{}; %%
    \node[ellipse, rotate fit=40, inner sep=0pt,%
      fill=red!30, opacity=0.3, draw, fit = (x4) (x7)]{}; %%
    \node[ellipse, rotate fit=350, inner sep=0pt,%
      fill=red!30, opacity=0.3, draw, fit = (x7) (x8) (x9)]{}; %%
    \node[ellipse, rotate fit=30, inner sep=0pt,%
      fill=red!30, opacity=0.3, draw, fit = (x2) (x3) (x5) (x6) (x8) (x9)]{}; %%
    \node[ellipse, rotate fit=30, inner sep=0pt,%
      fill=red!30, opacity=0.3, draw, fit = (x2) (x3) (x5) ]{}; %%
    \node[ellipse, rotate fit=5, inner sep=3pt,%
      fill=red!30, opacity=0.3, draw, fit = (x1) (x4)]{}; %%
    \end{pgfonlayer}
  \end{tikzpicture}
}%

\def\hypergraphi{%
  \begin{tikzpicture}[every node/.style={circle,inner sep=1pt,fill=none}]%
%   \draw[help lines] (0,0) grid (5,5);%
    \draw%
      (1,3)       node(x5) {$x_5$} %
      (0,2.25)    node(x3) {$x_3$} %
      (1,2)       node(x2) {$x_2$} %
      (3,2.5)     node(x8) {$x_8$} %
      (3,3)       node(x9) {$x_9$} %
      (2,4)       node(x6) {$x_6$} %
      (0,0)       node(x1) {$x_1$} %
      (3.5,1.5)   node(x7) {$x_7$} %
      (3,0)       node(x4) {$x_4$} %
      ;%

    \begin{pgfonlayer}{background}
    \node[ellipse, rotate fit=40, inner sep=0pt,%
      fill=red!30, opacity=0.3, draw, fit = (x1) (x2)]{}; %%
    \node[ellipse, rotate fit=40, inner sep=0pt,%
      fill=red!30, opacity=0.3, draw, fit = (x4) (x7)]{}; %%
    \node[ellipse, rotate fit=350, inner sep=0pt,%
      fill=red!30, opacity=0.3, draw, fit = (x7) (x8) (x9)]{}; %%
    \node[ellipse, rotate fit=30, inner sep=0pt,%
      fill=red!30, opacity=0.3, draw, fit = (x2) (x3) (x5) (x6) (x8) (x9)]{}; %%
    \node[ellipse, rotate fit=30, inner sep=0pt,%
      fill=red!30, opacity=0.3, draw, fit = (x2) (x3) (x5) ]{}; %%
   \end{pgfonlayer}
  \end{tikzpicture}
}%


\def\pathhypergraphi{%
  \begin{tikzpicture}[every node/.style={circle,inner sep=1pt,fill=none}]%
    % \draw[help lines] (-2,0) grid (3,5);%
    \draw%
      (0,2) node[fill,circle=2pt](v5){} --%
      (1,2) node[fill,circle=2pt](v3){} --%
      (2,2) node[fill,circle=2pt](v2){} --%
      (3,2) node[fill,circle=2pt](v8){} --%
      (4,2) node[fill,circle=2pt](v9){} --%
      (5,2) node[fill,circle=2pt](v6){} %
      (2,1) node[fill,circle=2pt](v1){} %
      (4,1) node[fill,circle=2pt](v7){} --%
      (5,1) node[fill,circle=2pt](v4){}%
      ;%

    \draw%
      (v2) -- (v1)%
      (v9) -- (v7)%
      ;%

    \draw%
      (v1) node[below](v1){$v_1$} %
      (v2) node[above](v2){$v_2$} %
      (v3) node[above](v3){$v_3$} %
      (v5) node[above](v5){$v_5$} %
      (v6) node[above](v6){$v_6$} %
      (v8) node[above](v8){$v_8$} %
      (v9) node[above](v9){$v_9$} %
      (v7) node[below](v7){$v_7$} %
      (v4) node[below](v4){$v_4$}%
      ;%

    \begin{pgfonlayer}{background}
    \node[rectangle, rounded corners=5pt, inner sep=0pt,%
      fill=red!30, opacity=0.3, draw, fit = (v1) (v2)]{}; %%
    \node[rectangle, rounded corners=5pt, inner sep=1pt,%
      fill=red!30, opacity=0.3, draw, fit = (v4) (v7)]{}; %%
    \node[rectangle, rounded corners=5pt, inner sep=5pt,%
      fill=red!30, opacity=0.3, draw, fit = (v7) (v8) (v9)]{}; %%
    \node[rectangle, rounded corners=5pt, inner sep=1pt,%
      fill=red!30, opacity=0.3, draw, fit = (v2) (v3) (v5) (v6) (v8) (v9)]{}; %%
    \node[rectangle, rounded corners=5pt, inner sep=5pt,%
      fill=red!30, opacity=0.3, draw, fit = (v2) (v3) (v5) ]{}; %%
    \end{pgfonlayer}
  \end{tikzpicture}
}%

\def\intervalhypergraphi{%
  \begin{tikzpicture}[every node/.style={circle,inner sep=1pt,fill=none}]%
    % \draw[help lines] (-2,0) grid (3,5);%
    \draw%
      (0,0) node[fill,circle=2pt](i1){} --%
      (1,0) node[fill,circle=2pt](i2){} --%
      (2,0) node[fill,circle=2pt](i3){} --%
      (3,0) node[fill,circle=2pt](i5){} --%
      (4,0) node[fill,circle=2pt](i6){} --%
      (5,0) node[fill,circle=2pt](i8){} --%
      (6,0) node[fill,circle=2pt](i9){} --%
      (7,0) node[fill,circle=2pt](i7){} --%
      (8,0) node[fill,circle=2pt](i4){}%
      ;%
    \draw%
      (i1) node[below](i1){$i_1$} %
      (i2) node[below](i2){$i_2$} %
      (i3) node[below](i3){$i_3$} %
      (i5) node[below](i5){$i_5$} %
      (i6) node[below](i6){$i_6$} %
      (i8) node[below](i8){$i_8$} %
      (i9) node[below](i9){$i_9$} %
      (i7) node[below](i7){$i_7$} %
      (i4) node[below](i4){$i_4$}%
      ;%

    \begin{pgfonlayer}{background}
    \node[rectangle, rounded corners=5pt, inner sep=1pt,%
      fill=red!30, opacity=0.3, draw, fit = (i1) (i2)]{}; %%
    \node[rectangle, rounded corners=5pt, inner sep=1pt,%
      fill=red!30, opacity=0.3, draw, fit = (i4) (i7)]{}; %%
    \node[rectangle, rounded corners=5pt, inner sep=7pt,%
      fill=red!30, opacity=0.3, draw, fit = (i7) (i8) (i9)]{}; %%
    \node[rectangle, rounded corners=5pt, inner sep=3pt,%
      fill=red!30, opacity=0.3, draw, fit = (i2) (i3) (i5) (i6) (i8) (i9)]{}; %%
    \node[rectangle, rounded corners=5pt, inner sep=7pt,%
      fill=red!30, opacity=0.3, draw, fit = (i2) (i3) (i5) ]{}; %%
    \end{pgfonlayer}
  \end{tikzpicture}
}%


\def\hypergraphii{%
  \begin{tikzpicture}[every node/.style={circle,inner sep=1pt,fill=none}]%

    % \draw[help lines] (-2,0) grid (3,5);%

    \draw%
      (0,3)     node(y1){$y_1$}%
      (0,1.5)   node(y2){$y_2$}%
      (0,0)     node(y3){$y_3$}%
      (1.5,3)   node(y4){$y_4$}%
      (1.5,1.5) node(y5){$y_5$}%
      (1.5,0)   node(y6){$y_6$}%
      (3,3)     node(y7){$y_7$}%
      (3,1.5)   node(y8){$y_8$}%
      (3,0)     node(y9){$y_9$}%
      ;%

    \begin{pgfonlayer}{background}
%    \node[ellipse, inner sep=0pt,%
    \node[rectangle, rounded corners=5pt, inner sep=3pt,%
      fill=red!30, opacity=0.25, draw, fit = (y1) (y2)]{}; %%
%    \node[ellipse, inner sep=0pt,%
    \node[rectangle, rounded corners=5pt, inner sep=7pt,%
      fill=red!30, opacity=0.25, draw, fit = (y4) (y7)]{}; %%
%    \node[rectangle, rounded corners=5pt, inner sep=0pt,%
    \node[rectangle, rounded corners=5pt, inner sep=3pt,%
      fill=red!30, opacity=0.25, draw, fit = (y7) (y8) (y9)]{}; %%
%    \node[ellipse, inner sep=0pt,%
    \node[rectangle, rounded corners=5pt, inner sep=7pt,%
      fill=red!30, opacity=0.25, draw, fit = (y2) (y3) (y5) (y6) (y8) (y9)]{}; %%
%    \node[ellipse, inner sep=0pt,%
    \node[rectangle, rounded corners=5pt, inner sep=3pt,%
      fill=red!30, opacity=0.25, draw, rotate fit=45, fit = (y2) (y3) (y5) ]{}; %%
    \end{pgfonlayer}
  \end{tikzpicture}
}%
